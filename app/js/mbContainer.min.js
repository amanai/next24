(function(c){var a=c.browser.msie&&c.browser.version=="6.0";var b=c.browser.opera;jQuery.fn.buildContainers=function(d){return this.each(function(){if(c(this).is("[inited=true]")){return}this.options={containment:"document",elementsPath:"elements/",onMinimize:function(){},onIconize:function(){},onClose:function(){},minimizeEffect:"slide",effectDuration:300};c.extend(this.options,d);var f=c(this);f.attr("inited","true");f.attr("iconized","false");f.attr("collapsed","false");f.attr("closed","false");f.attr("options",this.options);if(c.metadata){c.metadata.setType("class");if(f.metadata().skin){f.attr("skin",f.metadata().skin)}if(f.metadata().collapsed){f.attr("collapsed",f.metadata().collapsed)}if(f.metadata().iconized){f.attr("iconized",f.metadata().iconized)}if(f.metadata().icon){f.attr("icon",f.metadata().icon)}if(f.metadata().buttons){f.attr("buttons",f.metadata().buttons)}if(f.metadata().content){f.attr("content",f.metadata().content)}if(f.metadata().aspectRatio){f.attr("aspectRatio",f.metadata().aspectRatio)}if(f.metadata().handles){f.attr("handles",f.metadata().handles)}if(f.metadata().width){f.attr("width",f.metadata().width)}if(f.metadata().height){f.attr("height",f.metadata().height)}}if(f.attr("content")){var g=f.find(".content:first");g.mb_changeContent(f.attr("content"))}f.addClass(f.attr("skin"));if(!f.attr("collapsed")){f.attr("collapsed","false")}f.find(".n:first").attr("unselectable","on");if(!f.find(".n:first").html()){f.find(".n:first").html("&nbsp;")}f.containerSetIcon(f.attr("icon"),this.options.elementsPath);if(f.attr("buttons")){f.containerSetButtons(f.attr("buttons"),this.options)}f.css({width:"99.9%"});if(f.attr("width")){var e=c.browser.msie?f.attr("width"):f.attr("width")+"px";f.css({width:e})}if(f.attr("height")){f.find(".c:first , .content:first").css("height",f.attr("height")-f.find(".n:first").outerHeight()-(f.find(".s:first").outerHeight()))}if(f.hasClass("draggable")){f.css({position:"absolute",margin:0});f.find(".n:first").css({cursor:"move"});f.mb_BringToFront();f.draggable({handle:".n:first",cancel:".c",delay:0,containment:this.options.containment});f.bind("mousedown",function(){c(this).mb_BringToFront()})}if(f.hasClass("resizable")){f.containerResize()}if(f.attr("collapsed")=="true"){f.attr("collapsed","false");f.containerMinimize(this.options)}if(f.attr("iconized")=="true"){f.attr("iconized","false");f.containerIconize(this.options)}})};jQuery.fn.containerResize=function(){var e=c(this).hasClass("draggable");var d=c(this).attr("handles")?c(this).attr("handles"):"s";var f=c(this).attr("aspectRatio")?c(this).attr("aspectRatio"):false;c(this).resizable({handles:e?"":d,aspectRatio:f,minWidth:150,minHeight:150,iframeFix:true,helper:"mbproxy",start:function(g,h){h.helper.mb_BringToFront()},stop:function(j,k){var i=c(this);var g=i.outerHeight()-c(this).find(".n:first").outerHeight()-(c(this).find(".s:first").outerHeight());c(this).find(".c:first , .content:first").css({height:g});if(!e&&!c(this).attr("handles")){var h=c(this).attr("width")&&c(this).attr("width")>0?c(this).attr("width"):"99.9%";c(this).css({width:h})}}});c(this).find(".ui-resizable-n").addClass("mb-resize");c(this).find(".ui-resizable-s").addClass("mb-resize");c(this).find(".ui-resizable-se").addClass("mb-resize");c(this).find(".ui-resizable-w").addClass("mb-resize");c(this).find(".ui-resizable-e").addClass("mb-resize")};jQuery.fn.containerSetIcon=function(d,e){if(d&&d!=""){c(this).find(".ne:first").prepend("<img class='icon' src='"+e+"icons/"+d+"' style='position:absolute'>");c(this).find(".n:first").css({paddingLeft:15})}else{c(this).find(".n:first").css({paddingLeft:0})}};jQuery.fn.containerSetButtons=function(j,h){var k=h.elementsPath;var d=c(this);if(j!=""){var g=j.split(",");c(this).find(".ne:first").append("<div class='buttonBar'></div>");for(var f in g){if(g[f]=="c"){c(this).find(".buttonBar:first").append("<img src='"+k+c(this).attr("skin")+"/close.png' class='close'>");c(this).find(".close:first").bind("click",function(){if(!c.browser.msie){d.fadeOut(h.effectDuration)}else{d.hide()}d.attr("closed","true");h.onClose()})}if(g[f]=="m"){c(this).find(".buttonBar:first").append("<img src='"+k+c(this).attr("skin")+"/min.png' class='collapsedContainer'>");c(this).find(".collapsedContainer:first").bind("click",function(){d.containerMinimize(h)});c(this).find(".n:first").bind("dblclick",function(){d.containerMinimize(h)})}if(g[f]=="p"){c(this).find(".buttonBar:first").append("<img src='"+k+c(this).attr("skin")+"/print.png' class='printContainer'>");c(this).find(".printContainer:first").bind("click",function(){})}if(g[f]=="i"){c(this).find(".buttonBar:first").append("<img src='"+k+c(this).attr("skin")+"/iconize.png' class='iconizeContainer'>");c(this).find(".iconizeContainer:first").bind("click",function(){d.containerIconize(h)})}}var e=c.browser.mozilla||c.browser.safari;if(e){c(this).find(".buttonBar:first img").css({opacity:0.5,cursor:"pointer",mozUserSelect:"none",khtmlUserSelect:"none"}).mouseover(function(){c(this).fadeTo(200,1)}).mouseout(function(){if(e){c(this).fadeTo(200,0.5)}})}c(this).find(".buttonBar:first img").attr("unselectable","on")}};jQuery.fn.containerMinimize=function(d){this.each(function(){if(!d){d=c(this).attr("options")}var e=c(this);if(c(this).attr("collapsed")=="false"){e.attr("w",e.outerWidth());e.attr("h",e.outerHeight());if(d.minimizeEffect=="fade"){e.find(".o:first").fadeOut(d.effectDuration,function(){})}else{e.find(".icon:first").hide();e.find(".o:first").slideUp(d.effectDuration,function(){});e.animate({height:e.find(".n:first").outerHeight()+e.find(".s:first").outerHeight()},d.effectDuration,function(){e.find(".icon:first").show()})}e.attr("collapsed","true");e.find(".collapsedContainer:first").attr("src",d.elementsPath+c(this).attr("skin")+"/max.png");e.resizable("destroy");if(d.onMinimize){d.onMinimize()}}else{if(d.minimizeEffect=="fade"){e.find(".o:first").fadeIn(d.effectDuration,function(){})}else{e.find(".o:first").slideDown(d.effectDuration,function(){});e.find(".icon:first").hide();e.animate({height:e.attr("h")},d.effectDuration,function(){e.find(".icon:first").show()})}if(e.hasClass("resizable")){e.containerResize()}e.attr("collapsed","false");e.find(".collapsedContainer:first").attr("src",d.elementsPath+c(this).attr("skin")+"/min.png")}})};jQuery.fn.containerIconize=function(d){if(!d){d=c(this).attr("options")}return this.each(function(){var e=c(this);e.attr("iconized","true");if(e.attr("collapsed")=="false"){e.attr("h",e.outerHeight())}e.attr("w",e.attr("width")&&e.attr("width")>0?(!e.hasClass("resizable")?e.attr("width"):e.width()):!c(this).attr("handles")?"99.9%":e.width());e.attr("t",e.css("top"));e.attr("l",e.css("left"));e.resizable("destroy");if(!c.browser.msie){e.find(".no:first").slideUp("fast");e.animate({height:"32px",width:"32px",left:0},d.effectDuration)}else{e.find(".no:first").hide();e.css({height:"32px",width:"32px",left:0})}e.append("<img src='"+d.elementsPath+"/icons/"+(e.attr("icon")?e.attr("icon"):"restore.png")+"' class='restoreContainer' width='32'>");if(d.onIconize){d.onIconize()}e.find(".restoreContainer:first").attr("title",e.find(".n:first").html()).bind("click",function(){e.attr("iconized","false");if(!c.browser.msie){e.find(".no:first").fadeIn("fast");if(e.attr("collapsed")=="false"){e.animate({height:e.attr("h"),width:e.attr("w"),left:e.attr("l")},d.effectDuration);e.find(".c:first , .content:first").css("height",e.attr("h")-e.find(".n:first").outerHeight()-(e.find(".s:first").outerHeight()))}else{e.animate({height:"60px",width:e.attr("w"),left:e.attr("l")},d.effectDuration)}}else{e.find(".no:first").show();if(e.attr("collapsed")=="false"){e.css({height:e.attr("h"),width:e.attr("w"),left:e.attr("l")},d.effectDuration);e.find(".c:first , .content:first").css("height",e.attr("h")-e.find(".n:first").outerHeight()-(e.find(".s:first").outerHeight()))}else{e.css({height:"60px",width:e.attr("w"),left:e.attr("l")},d.effectDuration)}}e.find(".restoreContainer:first").remove();if(e.hasClass("resizable")&&e.attr("collapsed")=="false"){e.containerResize()}})})};jQuery.fn.mb_resizeTo=function(f,e){if(!e){e=c(this).outerWidth()}if(!f){f=c(this).outerHeight()}var d=f-c(this).find(".n:first").outerHeight()-(c(this).find(".s:first").outerHeight());c(this).find(".c:first , .content:first").animate({height:d});c(this).animate({height:f});c(this).animate({width:e})};jQuery.fn.mb_iconize=function(){if(c(this).attr("closed")=="false"){if(c(this).attr("iconized")=="true"){c(this).find(".restoreContainer:first").click()}else{c(this).containerIconize()}}};jQuery.fn.mb_open=function(){if(c(this).attr("closed")=="true"){if(!c.browser.msie){c(this).fadeIn(300)}else{c(this).show()}c(this).attr("closed","false")}};jQuery.fn.mb_close=function(){if(c(this).attr("closed")=="false"){c(this).find(".close:first").click()}};jQuery.fn.mb_toggle=function(){if(c(this).attr("closed")=="false"&&c(this).attr("iconized")=="false"){c(this).containerMinimize()}};jQuery.fn.mb_BringToFront=function(){var d=10;c("*").each(function(){if(c(this).css("position")=="absolute"){var e=parseInt(c(this).css("zIndex"));d=e>d?parseInt(c(this).css("zIndex")):d}});c(this).css("zIndex",d+=1)};jQuery.fn.mb_changeContent=function(e,f){var d=c(this);if(!f){f=""}c.ajax({type:"POST",url:e,data:f,success:function(g){d.html(g)}})};jQuery.fn.mb_getState=function(d){var e=c(this).attr(d);if(e=="true"){e=true}if(e=="false"){e=false}return e}})(jQuery);
